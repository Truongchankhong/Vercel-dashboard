import xlsx from 'xlsx';
import fs from 'fs';
import path from 'path';

const inputPath = path.join(process.cwd(), 'data', 'Powerapp.xlsx');
const outputPath = path.join(process.cwd(), 'data', 'powerapp.json');

try {
  if (!fs.existsSync(inputPath)) {
    throw new Error('‚ùå Kh√¥ng t√¨m th·∫•y file Powerapp.xlsx trong th∆∞ m·ª•c /data');
  }

  const workbook = xlsx.readFile(inputPath);
  const sheetName = workbook.SheetNames[0];
  const sheet = workbook.Sheets[sheetName];

  // S·ª≠ d·ª•ng header th·ª±c t·∫ø thay v√¨ index
  const json = xlsx.utils.sheet_to_json(sheet, {
    defval: "",     // gi·ªØ √¥ tr·ªëng l√† chu·ªói r·ªóng thay v√¨ undefined
    raw: false      // √©p d·ªØ li·ªáu v·ªÅ d·∫°ng string n·∫øu c√≥ th·ªÉ
  });

  fs.writeFileSync(outputPath, JSON.stringify(json, null, 2), 'utf-8');
  console.log('‚úÖ ƒê√£ t·∫°o file powerapp.json th√†nh c√¥ng!');
} catch (error) {
  console.error('üö´ L·ªói:', error.message);
}
